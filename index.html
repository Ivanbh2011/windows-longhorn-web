
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador Windows Longhorn (Frutiger Aero)</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #E0E0E0;
    }

    /* -------------------------- BOOT SCREEN -------------------------- */
    #screen {
      color: white;
      background: black;
      width: 100vw;
      height: 100vh;
      padding: 10px;
      box-sizing: border-box;
      white-space: pre-wrap;
      font-family: 'Consolas', 'Lucida Console', monospace;
      font-size: 14px;
      line-height: 1.5;
    }

    /* -------------------------- OPERATING SYSTEM (OS) -------------------------- */
    #os {
      display: none;
      width: 100vw;
      height: 100vh;
      position: relative;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      /* background: linear-gradient(135deg, #7ad7f0, #4a90e2, #2a6edc); */
    }

    /* -------------------------- WINDOWS -------------------------- */
    .window {
      border: 1px solid rgba(0,0,0,0.1);
      box-shadow: 0 5px 15px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.2);
      z-index: 10;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(5px);
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .window .title-bar {
      padding: 6px 10px;
      cursor: grab;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: bold;
      color: white;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
      background: linear-gradient(to bottom, #72aee6 0%, #4f8fdc 50%, #2f6cb0 100%);
      border-bottom: 1px solid rgba(0,0,0,0.2);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.3);
      flex-shrink: 0;
      border-top-left-radius: 7px;
      border-top-right-radius: 7px;
    }
    .window .title-bar span {
      user-select: none;
    }
    .window .title-bar .controls span {
        display: inline-block;
        width: 24px;
        height: 20px;
        line-height: 18px;
        text-align: center;
        margin-left: 5px;
        border: 1px solid rgba(0,0,0,0.2);
        background: linear-gradient(to bottom, #e8e8e8, #d8d8d8);
        color: #333;
        cursor: pointer;
        font-family: 'Segoe UI Symbol', sans-serif;
        font-size: 14px;
        vertical-align: middle;
        border-radius: 4px;
        box-shadow: 0 1px 2px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.7);
    }
    .window .title-bar .controls span:hover {
        background: linear-gradient(to bottom, #f0f0f0, #e0e0e0);
        box-shadow: 0 1px 3px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.8);
    }
    .window .title-bar .controls span:active {
        background: linear-gradient(to top, #d0d0d0, #e0e0e0);
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
    }
    .window .title-bar .controls span:last-child {
        background: linear-gradient(to bottom, #f75555, #c73333);
        color: white;
        text-shadow: 1px 1px 1px rgba(0,0,0,0.4);
    }
    .window .title-bar .controls span:last-child:hover {
        background: linear-gradient(to bottom, #ff7777, #e04444);
        box-shadow: 0 1px 3px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.7);
    }
    .window .title-bar .controls span:active {
        background: linear-gradient(to top, #c73333, #f75555);
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.4);
    }

    .window textarea {
      font-family: 'Segoe UI', Arial, sans-serif;
      width: calc(100% - 8px);
      height: calc(100% - 8px);
      resize: none;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 4px;
      box-sizing: border-box;
      outline: none;
    }

    /* -------------------------- TASKBAR -------------------------- */
    #taskbar {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 48px;
      background: linear-gradient(to bottom, rgba(70, 150, 220, 0.8), rgba(30, 100, 180, 0.8));
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: space-between;
      color: white;
      padding: 0 15px;
      font-size: 15px;
      box-sizing: border-box;
      z-index: 100;
      border-top: 1px solid rgba(255,255,255,0.3);
      box-shadow: 0 -2px 10px rgba(0,0,0,0.3);
    }
    #start-button {
      background: linear-gradient(to bottom, #5bb4ef 0%, #0078d4 100%);
      border: 1px solid rgba(0,0,0,0.2);
      padding: 8px 20px;
      cursor: pointer;
      font-weight: bold;
      border-radius: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.5);
      text-shadow: 1px 1px 1px rgba(0,0,0,0.4);
      transition: all 0.1s ease;
    }
    #start-button:hover {
        background: linear-gradient(to bottom, #6cd6ff 0%, #1a8ceb 100%);
        box-shadow: 0 3px 8px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.7);
    }
    #start-button:active {
        background: linear-gradient(to top, #5bb4ef 0%, #0078d4 100%);
        box-shadow: inset 0 1px 5px rgba(0,0,0,0.4);
        transform: translateY(1px);
    }
    #clock {
        background: rgba(255,255,255,0.2);
        padding: 5px 10px;
        border-radius: 4px;
        border: 1px solid rgba(255,255,255,0.1);
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }

    /* -------------------------- START MENU -------------------------- */
    #start-menu {
      position: absolute;
      bottom: 48px;
      left: 0;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0,0,0,0.2);
      border-radius: 8px 8px 0 0;
      display: none;
      flex-direction: column;
      min-width: 250px;
      font-family: 'Segoe UI', Arial, sans-serif;
      box-shadow: 0 -5px 15px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.7);
      z-index: 90;
      overflow: hidden;
    }
    #start-menu div {
      padding: 12px 15px;
      cursor: pointer;
      border-bottom: 1px solid rgba(0,0,0,0.1);
      color: #333;
      transition: background 0.2s ease, color 0.2s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    #start-menu div:hover {
        background: linear-gradient(to right, #316AC5, #5fa8e5);
        color: white;
        text-shadow: 1px 1px 1px rgba(0,0,0,0.3);
    }
    #start-menu div:last-child {
        border-bottom: none;
    }

    /* -------------------------- DESKTOP ICONS -------------------------- */
    #desktop-icons {
      position: absolute;
      top: 20px;
      left: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      color: white;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.6);
    }
    .desktop-icon {
      text-align: center;
      cursor: pointer;
      width: 80px;
      padding: 8px;
      border-radius: 8px;
      transition: background 0.2s ease;
      font-size: 14px;
    }
    .desktop-icon:hover {
        background: rgba(255,255,255,0.25);
        box-shadow: 0 0 8px rgba(255,255,255,0.5), inset 0 0 5px rgba(255,255,255,0.3);
    }

    /* -------------------------- PAINT APP -------------------------- */
    .paint-app-controls {
        display: flex;
        align-items: center;
        padding: 8px;
        background: rgba(240, 240, 240, 0.9);
        border-bottom: 1px solid rgba(0,0,0,0.1);
        flex-shrink: 0;
        box-shadow: inset 0 -1px 0 rgba(255,255,255,0.7);
    }
    .paint-app-controls label, .paint-app-controls input, .paint-app-controls button {
        margin-right: 12px;
        font-family: 'Segoe UI', Arial, sans-serif;
        font-size: 13px;
    }
    .paint-app-controls input[type="color"] {
        width: 35px;
        height: 25px;
        border: 1px solid #ccc;
        padding: 0;
        border-radius: 4px;
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }
    .paint-app-controls input[type="range"] {
        width: 100px;
        -webkit-appearance: none;
        height: 8px;
        background: linear-gradient(to right, #ccc, #eee);
        border-radius: 5px;
        outline: none;
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
    }
    .paint-app-controls input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: linear-gradient(to bottom, #87cefa, #4682b4);
        cursor: pointer;
        border: 1px solid #333;
        box-shadow: 0 1px 3px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.8);
    }
    .paint-app-controls button {
        background: linear-gradient(to bottom, #e0e0e0, #c0c0c0);
        border: 1px solid #a0a0a0;
        padding: 6px 15px;
        border-radius: 5px;
        cursor: pointer;
        box-shadow: 0 1px 2px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.7);
        transition: all 0.1s ease;
    }
    .paint-app-controls button:hover {
        background: linear-gradient(to bottom, #f0f0f0, #d0d0d0);
        box-shadow: 0 2px 4px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.8);
    }
    .paint-app-controls button:active {
        background: linear-gradient(to top, #e0e0e0, #c0c0c0);
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
        transform: translateY(1px);
    }
    .paint-app-canvas {
        flex-grow: 1;
        background: white;
        cursor: crosshair;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin: 5px;
    }

    /* -------------------------- CMD APP -------------------------- */
    #cmd-output {
        padding: 10px;
        height: calc(100% - 70px);
        overflow-y: auto;
        white-space: pre-wrap;
        color: lime;
    }
    #cmd-input {
        flex-grow: 1;
        background: black;
        color: lime;
        border: none;
        font-family: 'Consolas', 'Lucida Console', monospace;
        outline: none;
        padding: 5px;
        border-radius: 4px;
    }
    .window.cmd-window {
        background: rgba(0,0,0,0.9);
        backdrop-filter: blur(0px);
        border: 1px solid #333;
        border-radius: 8px;
    }
    .window.cmd-window .title-bar {
        background: linear-gradient(to bottom, #444, #222);
        color: #eee;
    }

    /* -------------------------- CHROME BROWSER APP -------------------------- */
    .chrome-window .browser-toolbar {
        background: #e9e9e9;
        border-bottom: 1px solid #ccc;
        padding: 5px 10px;
        display: flex;
        align-items: center;
        flex-shrink: 0;
    }
    .chrome-window .browser-toolbar .tabs button {
        background: linear-gradient(to bottom, #f0f0f0, #e0e0e0);
        border: 1px solid #ccc;
        border-bottom: none;
        border-radius: 5px 5px 0 0;
        padding: 5px 12px;
        margin-right: 2px;
        cursor: pointer;
        font-size: 13px;
        color: #333;
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.7);
    }
    .chrome-window .browser-toolbar .tabs button.active {
        background: white;
        border-bottom: 1px solid white;
        font-weight: bold;
    }
    .chrome-window .browser-toolbar .address-bar {
        flex-grow: 1;
        background: white;
        border: 1px solid #ccc;
        border-radius: 15px;
        padding: 4px 10px;
        margin-left: 10px;
        font-size: 13px;
        color: #555;
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        display: flex; /* Para centrar el texto si es necesario */
        align-items: center;
        overflow: hidden; /* Asegura que el texto no se salga */
        white-space: nowrap; /* Evita que el texto se envuelva */
        text-overflow: ellipsis; /* A√±ade puntos suspensivos si el texto es demasiado largo */
    }
    .chrome-window iframe {
        flex-grow: 1;
        width: 100%;
        height: 100%;
        border: none;
        background-color: white; /* Fallback */
    }
    /* Estilos para el juego del dinosaurio */
    .dino-game-container {
        flex-grow: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #f7f7f7; /* Un fondo claro para el juego */
    }
    .dino-game-container iframe {
        width: 100%;
        height: 100%;
        max-width: 800px; /* Tama√±o m√°ximo para el juego */
        max-height: 400px;
        border: none;
    }


    /* -------------------------- BIOS / BLUE SCREEN / CRITICAL ERROR -------------------------- */
    #simulated-bios {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: #000080;
        color: #AAAAAA;
        font-family: "Lucida Console", "Consolas", monospace;
        font-size: 16px;
        padding: 20px;
        box-sizing: border-box;
        line-height: 1.5;
        z-index: 1000;
    }
    #simulated-bios .bios-header {
        color: #F0F0F0;
        font-weight: bold;
        text-align: center;
        margin-bottom: 20px;
        font-size: 20px;
    }
    #simulated-bios .bios-menu {
        margin-top: 30px;
        margin-left: 50px;
    }
    #simulated-bios .bios-menu-item {
        padding: 5px 0;
        cursor: pointer;
    }
    #simulated-bios .bios-menu-item.selected {
        background: #0000FF;
        color: #FFFFFF;
    }
    #simulated-bios .bios-footer {
        position: absolute;
        bottom: 20px;
        left: 20px;
        right: 20px;
        border-top: 1px solid #555555;
        padding-top: 10px;
        font-size: 14px;
    }

    /* Blue Screen of Death */
    .blue-screen-of-death {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: #0000AA;
        color: white;
        font-family: monospace;
        font-size: 20px;
        padding: 50px;
        box-sizing: border-box;
        z-index: 9999;
    }

    /* Critical Error Screen (BIOS Corruption Style) */
    #critical-error-screen {
        display: none !important; /* Mantenemos esto para que JavaScript lo active */
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: black; /* Fondo negro como en la imagen */
        color: white; /* Texto blanco */
        font-family: 'Consolas', 'Lucida Console', monospace; /* Fuente de tipo consola */
        font-size: 16px; /* Ajustamos el tama√±o de la fuente para que quepa bien */
        padding: 50px; /* Espaciado */
        box-sizing: border-box;
        text-align: left; /* Alineado a la izquierda */
        z-index: 9999;
        display: flex; /* Se activar√° como flex */
        flex-direction: column;
        justify-content: flex-start; /* Alinea el contenido al inicio (arriba) */
        align-items: flex-start; /* Alinea el contenido a la izquierda */
        line-height: 1.5; /* Espaciado entre l√≠neas para mejor lectura */
    }
    /* Estilos espec√≠ficos para el contenido de la pantalla de corrupci√≥n si necesitas */
    #critical-error-screen p {
        margin-bottom: 10px; /* Un poco de margen entre p√°rrafos */
    }
  </style>
</head>
<body>
  <div id="screen"></div>
  <div id="os">
    <div id="desktop-icons">
      <div class="desktop-icon" onclick="openNotepad()">üìù<br>Notepad</div>
      <div class="desktop-icon" onclick="openCmd()">üíª<br>CMD</div>
      <div class="desktop-icon" onclick="openPaint()">üé®<br>Paint</div>
      <div class="desktop-icon" onclick="openChrome()">üåê<br>Chrome</div> </div>
    <div id="start-menu">
      <div onclick="openNotepad()">üìù Notepad</div>
      <div onclick="openCmd()">üíª CMD</div>
      <div onclick="openPaint()">üé® Paint</div>
      <div onclick="openChrome()">üåê Chrome</div> <div onclick="window.location.reload();">Reiniciar</div>
    </div>
    <div id="taskbar">
      <div id="start-button" onclick="toggleStartMenu()">üü¶ Inicio</div>
      <div id="clock"></div>
    </div>
  </div>

  <div id="simulated-bios">
    <div class="bios-header">
      AWARD SOFTWARE, INC. CMOS SETUP UTILITY
    </div>
    <div class="bios-menu">
      <div class="bios-menu-item selected" data-action="normal">Standard CMOS Features</div>
      <div class="bios-menu-item" data-action="normal">Advanced BIOS Features</div>
      <div class="bios-menu-item" data-action="normal">Integrated Peripherals</div>
      <div class="bios-menu-item" data-action="normal">Power Management Setup</div>
      <div class="bios-menu-item" data-action="critical-error">CRITICAL FILES & SYSTEM SETTINGS</div>
      <div class="bios-menu-item" data-action="normal">Load Setup Defaults</div>
      <div class="bios-menu-item" data-action="exit-save">Save & Exit Setup</div>
      <div class="bios-menu-item" data-action="exit-discard">Exit Without Saving</div>
    </div>
    <div class="bios-footer">
      <p>&#x2191;&#x2193; Select Item &nbsp; &nbsp; ENTER Select &nbsp; &nbsp; ESC Exit &nbsp; &nbsp; F1 General Help</p>
      <p>F5 Load Optimized Defaults &nbsp; F6 Load Fail-Safe Defaults &nbsp; F7 Save & Exit Setup</p>
    </div>
  </div>

  <div id="critical-error-screen">
      <p>BIOS corruption has been detected. BIOS recovery will begin automatically when you restart your PC.</p>
      <p>BIOS recovery will take several minutes.</p>
      <p>Do not shut down or remove external power from your PC during the process.</p>
      <p style="margin-top: 20px;">Press any key to continue...</p>
  </div>


  <script>
    const screen = document.getElementById("screen");
    const os = document.getElementById("os");
    const simulatedBios = document.getElementById("simulated-bios");
    const biosMenuItems = document.querySelectorAll('#simulated-bios .bios-menu-item');
    const criticalErrorScreen = document.getElementById("critical-error-screen");

    const lines = [
      "Award Modular BIOS v4.51PG, An Energy Star Ally",
      "Copyright (C) 1984-98, Award Software, Inc.",
      "",
      "ASUS P2B-D ACPI BIOS Revision 1014 Beta 003",
      "",
      "Pentium III 1396MHz Processor   , 2 Processor(s) Detected",
      "Memory Test : 131072K OK",
      "",
      "Award Plug and Play BIOS Extension v1.0A",
      "Initialize Plug and Play Cards...",
      "PNP Init Completed",
      "",
      "Trend ChipAwayVirus(R) On Guard",
      "",
      "Detecting HDD Primary Master  ... SAMSUNG SV4002H",
      "Detecting HDD Primary Slave   ... None",
      "Detecting HDD Secondary Master... ATAPI   DVD 2X16X4X16",
      "Detecting HDD Secondary Slave ... None_",
      "",
      "",
      "",
      "Press DEL to enter SETUP",
      "08/01/2002-I440BX-P2B-D"
    ];
    let index = 0;
    let bootTimeout; // Este ser√° el timeout para las l√≠neas de arranque
    let biosTimeout; // Este ser√° el timeout para el intervalo de la BIOS
    let biosEntered = false;
    let currentBiosSelection = 0;
    let bootSequenceStarted = false;

    function updateBiosSelection() {
        biosMenuItems.forEach((item, i) => {
            if (i === currentBiosSelection) {
                item.classList.add('selected');
            } else {
                item.classList.remove('selected');
            }
        });
    }

    // Nueva funci√≥n para iniciar la secuencia de arranque (l√≠neas de texto)
    function startBootSequence() {
        if (bootSequenceStarted) return;
        bootSequenceStarted = true;
        showBootLine();
    }

    // Funci√≥n para mostrar cada l√≠nea de arranque
    function showBootLine() {
      if (biosEntered) return; // Si ya estamos en la BIOS, no sigas mostrando l√≠neas

      if (index < lines.length) {
        let currentLine = lines[index];
        if (currentLine.includes("An Energy Star Ally")) {
            screen.innerHTML += currentLine.replace("An Energy Star Ally", "An <span style='color:#0f0;'>Energy</span> Star Ally") + "\n";
        } else {
            screen.innerText += currentLine + "\n";
        }
        index++;
        bootTimeout = setTimeout(showBootLine, 100);
      } else {
        // Todas las l√≠neas mostradas, proceder al SO
        setTimeout(() => {
          screen.style.display = 'none';
          os.style.display = 'block';
          os.style.backgroundImage = "url('386828.jpg')"; // Aseg√∫rate de tener esta imagen en la misma carpeta
          updateClock();
          setInterval(updateClock, 1000);
          // Cuando el OS carga, el listener inicial ya no es necesario para la BIOS
          document.removeEventListener('keydown', initialBootKeyListener, true);
        }, 2000);
      }
    }


    function enterSimulatedBIOS() {
        if (biosEntered) return; // Evitar entrar m√∫ltiples veces
        
        clearTimeout(bootTimeout); // Detiene la secuencia de arranque si estaba en curso
        clearTimeout(biosTimeout); // Detiene el temporizador de 7 segundos
        
        screen.style.display = 'none';
        simulatedBios.style.display = 'block';
        biosEntered = true;
        currentBiosSelection = 0;
        updateBiosSelection();
        document.addEventListener('keydown', handleBiosKeydown);
        document.removeEventListener('keydown', initialBootKeyListener, true); // Deshabilita el listener inicial
    }

    function exitSimulatedBIOS() {
        simulatedBios.style.display = 'none';
        biosEntered = false;
        index = 0;
        screen.innerText = "";
        screen.style.display = 'block';
        bootSequenceStarted = false; // Permite un nuevo arranque limpio
        startBootSequence(); // Inicia de nuevo el arranque normal
        document.removeEventListener('keydown', handleBiosKeydown);
        document.addEventListener('keydown', initialBootKeyListener, true); // Reactiva el listener inicial
    }

    function triggerCriticalError() {
        console.log("Activando pantalla de error cr√≠tico..."); // Para depuraci√≥n
        simulatedBios.style.display = 'none';
        screen.style.display = 'none';
        os.style.display = 'none';
        const existingBlueScreen = document.querySelector('.blue-screen-of-death');
        if (existingBlueScreen) {
            existingBlueScreen.style.display = 'none';
        }
        
        // Retraso para asegurar que los elementos previos se oculten
        setTimeout(() => {
            criticalErrorScreen.style.display = 'flex';
            // A√±adir un listener para cualquier tecla para reiniciar
            document.addEventListener('keydown', handleCriticalErrorScreenKeydown, { once: true });
        }, 50); // Peque√±o retardo de 50ms

        document.removeEventListener('keydown', handleBiosKeydown);
        document.removeEventListener('keydown', initialBootKeyListener, true);
        clearTimeout(bootTimeout);
        clearTimeout(biosTimeout); // Aseg√∫rate de limpiar todos los temporizadores
    }

    // Nuevo manejador de eventos para la pantalla de error cr√≠tico
    function handleCriticalErrorScreenKeydown() {
        window.location.reload(); // Reinicia la p√°gina para simular la "recuperaci√≥n"
    }


    // Listener para la tecla '5' al inicio, dentro del intervalo de 7 segundos
    function initialBootKeyListener(e) {
        if ((e.key === '5' || e.keyCode === 53)) { // Solo nos importa la tecla 5
            e.preventDefault();
            enterSimulatedBIOS();
        }
    }

    // Manejador de teclas DENTRO de la BIOS
    function handleBiosKeydown(e) {
        e.preventDefault();

        if (e.key === 'ArrowUp' || e.keyCode === 38) {
            currentBiosSelection = (currentBiosSelection - 1 + biosMenuItems.length) % biosMenuItems.length;
            updateBiosSelection();
        } else if (e.key === 'ArrowDown' || e.keyCode === 40) {
            currentBiosSelection = (currentBiosSelection + 1) % biosMenuItems.length;
            updateBiosSelection();
        } else if (e.key === 'Enter' || e.keyCode === 13) {
            const selectedAction = biosMenuItems[currentBiosSelection].dataset.action;
            console.log("Opci√≥n de BIOS seleccionada:", biosMenuItems[currentBiosSelection].textContent.trim(), "Acci√≥n:", selectedAction); // Para depuraci√≥n
            if (selectedAction === 'critical-error') {
                triggerCriticalError();
            } else if (selectedAction === 'exit-save' || selectedAction === 'exit-discard' || e.key === 'Escape' || e.keyCode === 27 || e.key === 'F7' || e.keyCode === 118) {
                exitSimulatedBIOS();
            } else if (selectedAction === 'normal') {
                // alert(`Entrando a ${biosMenuItems[currentBiosSelection].textContent.trim()}... (no implementado a√∫n)`);
            }
        } else if (e.key === 'Escape' || e.keyCode === 27) {
            exitSimulatedBIOS();
        } else if (e.key === 'F7' || e.keyCode === 118) {
             exitSimulatedBIOS();
        }
    }

    // Cuando la ventana carga, activamos el listener inicial y el temporizador
    window.onload = () => {
        document.addEventListener('keydown', initialBootKeyListener, true);

        // Inicia el temporizador de 7 segundos
        biosTimeout = setTimeout(() => {
            // Si el BIOS no se ha accedido, iniciar la secuencia de arranque normal
            if (!biosEntered) {
                document.removeEventListener('keydown', initialBootKeyListener, true); // Deshabilita el listener de la tecla 5
                startBootSequence();
            }
        }, 7000); // 7000 milisegundos = 7 segundos
    };

    // --- Existing functions for Notepad, CMD, Paint, Taskbar, BSOD ---

    function openNotepad() {
      const notepad = document.createElement('div');
      notepad.className = 'window';
      notepad.style.position = 'absolute';
      notepad.style.top = '100px';
      notepad.style.left = '100px';
      notepad.style.width = '400px';
      notepad.style.height = '300px';
      notepad.innerHTML = `
        <div class='title-bar'><span>üìù Notepad</span><div class="controls"><span style='font-size:16px;'>-</span><span style='font-size:16px;'>&#9723;</span><span onclick='this.closest(".window").remove()'>‚úñ</span></div></div>
        <textarea style='flex-grow:1;resize:none;border:none;padding:4px;box-sizing:border-box;'></textarea>
      `;
      os.appendChild(notepad);
      makeWindowDraggable(notepad);
    }

    function openCmd() {
      const cmd = document.createElement('div');
      cmd.className = 'window cmd-window';
      cmd.style.position = 'absolute';
      cmd.style.top = '150px';
      cmd.style.left = '150px';
      cmd.style.width = '600px';
      cmd.style.height = '400px';
      cmd.style.padding = '0';
      cmd.style.fontFamily = 'monospace';
      cmd.innerHTML = `
        <div class='title-bar'>
            <span>C:\\WINDOWS\\system32\\cmd.exe</span>
            <div class="controls">
                <span style='font-size:16px;'>-</span>
                <span style='font-size:16px;'>&#9723;</span>
                <span onclick='this.closest(".window").remove()'>‚úñ</span>
            </div>
        </div>
        <div id="cmd-output" style="padding:10px;height:calc(100% - 70px);overflow-y:auto;white-space:pre-wrap;">Microsoft Windows Longhorn [Version 5.2.3790]<br>(C) Copyright 1985-2003 Microsoft Corp.<br><br></div>
        <div style="display:flex;padding:0 10px 10px 10px;"><span style="margin-right:5px;">C:\\></span><input id="cmd-input" type="text" style="flex-grow:1;background:black;color:lime;border:none;font-family:monospace;outline:none;"></div>
      `;
      os.appendChild(cmd);
      makeWindowDraggable(cmd);

      const input = cmd.querySelector("#cmd-input");
      const output = cmd.querySelector("#cmd-output");

      input.focus();

      input.addEventListener("keydown", function(e) {
        if (e.key === "Enter") {
          const command = input.value.trim();
          output.innerText += `C:\\>${command}\n`;
          let result = "";
          if (command === "help") {
            result += "Available commands:\n";
            result += "  help          - Displays this help message.\n";
            result += "  echo [text]   - Displays the specified text.\n";
            result += "  clear         - Clears the command prompt screen.\n";
            result += "    delete system32 - Simulate a critical system error.\n";
            result += "  ipconfig      - Displays current network configuration.\n";
            result += "  dir           - Lists files and subdirectories.\n";
          } else if (command.startsWith("echo ")) {
            result += command.slice(5) + "\n";
          } else if (command === "clear") {
            output.innerText = "Microsoft Windows Longhorn [Version 5.2.3790]\n(C) Copyright 1985-2003 Microsoft Corp.\n\n";
            input.value = "";
            output.scrollTop = output.scrollHeight;
            return;
          } else if (command.toLowerCase() === "delete system32") {
            output.innerText += "Deleting critical system files... This may take a moment.\n";
            setTimeout(() => {
              os.style.display = 'none';
              blueScreen.style.display = 'block';
              simulateReboot();
            }, 2000);
            input.value = "";
            return;
          } else if (command === "ipconfig") {
            result += "Windows IP Configuration\n\n";
            result += "Ethernet adapter Local Area Connection:\n";
            result += "   Connection-specific DNS Suffix  . :\n";
            result += "   IP Address. . . . . . . . . . . . : 192.168.1.100\n";
            result += "   Subnet Mask . . . . . . . . . . . : 255.255.255.0\n";
            result += "   Default Gateway . . . . . . . . . : 192.168.1.1\n";
          } else if (command === "dir") {
            result += " Volume in drive C has no label.\n";
            result += " Volume Serial Number is 1234-5678\n\n";
            result += " Directory of C:\\\n\n";
            result += "06/16/2025  09:00 PM    <DIR>          Documents and Settings\n";
            result += "06/16/2025  09:00 PM    <DIR>          Program Files\n";
            result += "06/16/2025  09:00 PM    <DIR>          WINDOWS\n";
            result += "06/16/2025  09:00 PM             0     boot.ini\n";
            result += "06/16/2025  09:00 PM             0     pagefile.sys\n";
            result += "               2 File(s)              0 bytes\n";
            result += "               3 Dir(s)               X,XXX,XXX,XXX bytes free\n";
          }
          else {
            result += `'${command}' is not recognized as an internal or external command,\noperable program or batch file.\n`;
          }
          output.innerText += result;
          output.scrollTop = output.scrollHeight;
          input.value = "";
        }
      });
    }

    function openPaint() {
        const paintWindow = document.createElement('div');
        paintWindow.className = 'window';
        paintWindow.style.position = 'absolute';
        paintWindow.style.top = '50px';
        paintWindow.style.left = '50px';
        paintWindow.style.width = '700px';
        paintWindow.style.height = '500px';
        paintWindow.innerHTML = `
            <div class='title-bar'><span>üé® Paint</span><div class="controls"><span style='font-size:16px;'>-</span><span style='font-size:16px;'>&#9723;</span><span onclick='this.closest(".window").remove()'>‚úñ</span></div></div>
            <div class="paint-app-controls">
                <label for="paintColor">Color:</label>
                <input type="color" id="paintColor" value="#000000">
                <label for="brushSize">Tama√±o:</label>
                <input type="range" id="brushSize" min="1" max="20" value="5">
                <button id="clearCanvas">Borrar</button>
            </div>
            <canvas class="paint-app-canvas"></canvas>
        `;
        os.appendChild(paintWindow);
        makeWindowDraggable(paintWindow);

        const canvas = paintWindow.querySelector('.paint-app-canvas');
        const ctx = canvas.getContext('2d');
        const colorPicker = paintWindow.querySelector('#paintColor');
        const brushSizeSlider = paintWindow.querySelector('#brushSize');
        const clearButton = paintWindow.querySelector('#clearCanvas');

        const resizeCanvas = () => {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const parentWidth = canvas.parentElement.clientWidth;
            const parentHeight = canvas.parentElement.clientHeight - paintWindow.querySelector('.title-bar').offsetHeight - paintWindow.querySelector('.paint-app-controls').offsetHeight;

            canvas.width = parentWidth;
            canvas.height = parentHeight;
            ctx.putImageData(imageData, 0, 0);

            ctx.strokeStyle = colorPicker.value;
            ctx.lineWidth = brushSizeSlider.value;
            ctx.lineJoin = 'round';
            ctx.lineCap = 'round';
        };

        const observer = new MutationObserver(resizeCanvas);
        observer.observe(paintWindow, { attributes: true, childList: true, subtree: true });

        resizeCanvas();


        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;

        ctx.strokeStyle = colorPicker.value;
        ctx.lineWidth = brushSizeSlider.value;
        ctx.lineJoin = 'round';
        ctx.lineCap = 'round';

        const draw = (e) => {
            if (!isDrawing) return;

            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;

            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(mouseX, mouseY);
            ctx.stroke();

            lastX = mouseX;
            lastY = mouseY;
        };

        canvas.addEventListener('mousedown', (e) => {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            lastX = e.clientX - rect.left;
            lastY = e.clientY - rect.top;
        });

        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', () => { isDrawing = false; });
        canvas.addEventListener('mouseout', () => { isDrawing = false; });

        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            isDrawing = true;
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            lastX = touch.clientX - rect.left;
            lastY = touch.clientY - rect.top;
        }, { passive: false });
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            if (!isDrawing) return;
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            const touchX = touch.clientX - rect.left;
            const touchY = touch.clientY - rect.top;

            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(touchX, touchY);
            ctx.stroke();

            lastX = touchX;
            lastY = touchY;
        }, { passive: false });
        canvas.addEventListener('touchend', () => { isDrawing = false; });
        canvas.addEventListener('touchcancel', () => { isDrawing = false; });


        colorPicker.addEventListener('input', (e) => { ctx.strokeStyle = e.target.value; });
        brushSizeSlider.addEventListener('input', (e) => { ctx.lineWidth = e.target.value; });
        clearButton.addEventListener('click', () => { ctx.clearRect(0, 0, canvas.width, canvas.height); });

        paintWindow.addEventListener('remove', () => {
            observer.disconnect();
        });
    }

    // --- CHROME BROWSER APP FUNCTIONS ---
    function openChrome() {
        const chromeWindow = document.createElement('div');
        chromeWindow.className = 'window chrome-window';
        chromeWindow.style.position = 'absolute';
        chromeWindow.style.top = '80px';
        chromeWindow.style.left = '80px';
        chromeWindow.style.width = '800px';
        chromeWindow.style.height = '600px';
        chromeWindow.innerHTML = `
            <div class='title-bar'><span>üåê Chrome</span><div class="controls"><span style='font-size:16px;'>-</span><span style='font-size:16px;'>&#9723;</span><span onclick='this.closest(".window").remove()'>‚úñ</span></div></div>
            <div class="browser-toolbar">
                <div class="tabs">
                    <button class="active" data-url="dino">Dino Game</button>
                    <button data-url="github">GitHub</button>
                    <button data-url="google">Google</button>
                </div>
                <div class="address-bar">chrome://dino</div>
            </div>
            <div class="dino-game-container" id="chrome-content">
                </div>
        `;
        os.appendChild(chromeWindow);
        makeWindowDraggable(chromeWindow);

        const contentArea = chromeWindow.querySelector('#chrome-content');
        const addressBar = chromeWindow.querySelector('.address-bar');
        const tabButtons = chromeWindow.querySelectorAll('.browser-toolbar .tabs button');

        // Funci√≥n para cargar el contenido de la pesta√±a
        function loadTabContent(urlType) {
            contentArea.innerHTML = ''; // Limpia el contenido anterior
            let url = '';
            let iframeSrc = '';
            let iframeSandbox = ''; // Sin sandbox por defecto
            let iframeClassName = '';

            switch (urlType) {
                case 'dino':
                    url = 'chrome://dino';
                    // URL del juego del dinosaurio funcional (versi√≥n de c√≥digo abierto)
                    iframeSrc = 'https://chromedino.com/'; 
                    iframeSandbox = 'allow-scripts allow-same-origin allow-popups'; // Necesario para el juego
                    iframeClassName = 'dino-game-iframe';
                    // Reemplazamos el contenedor para centrar el juego
                    contentArea.className = 'dino-game-container';
                    break;
                case 'github':
                    url = 'https://github.com';
                    iframeSrc = 'https://github.com';
                    iframeSandbox = 'allow-scripts allow-same-origin allow-popups';
                    contentArea.className = ''; // Limpiar clase espec√≠fica si viene del dino
                    break;
                case 'google':
                    url = 'https://www.google.com';
                    iframeSrc = 'https://www.google.com';
                    iframeSandbox = 'allow-scripts allow-same-origin allow-popups';
                    contentArea.className = ''; // Limpiar clase espec√≠fica si viene del dino
                    break;
                default:
                    url = 'about:blank';
                    iframeSrc = 'about:blank';
                    contentArea.className = '';
            }

            addressBar.textContent = url;
            
            // Crea el iframe si hay un src
            if (iframeSrc) {
                const iframe = document.createElement('iframe');
                iframe.src = iframeSrc;
                iframe.frameBorder = '0';
                iframe.allowFullscreen = true;
                iframe.loading = 'lazy'; // Carga diferida
                if (iframeSandbox) {
                    iframe.setAttribute('sandbox', iframeSandbox);
                }
                if (iframeClassName) {
                    iframe.className = iframeClassName;
                }
                contentArea.appendChild(iframe);
            }

            // Actualiza los botones de la pesta√±a activa
            tabButtons.forEach(btn => {
                if (btn.dataset.url === urlType) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        // Asigna eventos a los botones de las pesta√±as
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                loadTabContent(button.dataset.url);
            });
        });

        // Carga el juego del dinosaurio por defecto al abrir el navegador
        loadTabContent('dino');
    }


    function toggleStartMenu() {
      const menu = document.getElementById("start-menu");
      menu.style.display = (menu.style.display === "none" || menu.style.display === "") ? "flex" : "none";
    }

    function updateClock() {
      const clock = document.getElementById("clock");
      const now = new Date();
      const time = now.toLocaleTimeString();
      const date = now.toLocaleDateString();
      clock.textContent = `${date} ${time}`;
    }

    const blueScreen = document.createElement('div');
    blueScreen.className = 'blue-screen-of-death';
    blueScreen.innerText = '*** STOP: 0x000000C1 (0x00000000, 0x00000000, 0x00000000, 0x00000000)\n\nAn unexpected kernel mode trap occurred.\n\n*** Address 0x80860000 has a value of 0x00000000\n\nBeginning dump of physical memory\nPhysical memory dump complete.\nContact your system administrator or technical support group for assistance.';
    document.body.appendChild(blueScreen);


    function simulateReboot() {
      setTimeout(() => {
        blueScreen.style.display = 'none';
        screen.innerText = "";
        screen.style.display = 'block';
        index = 0;
        biosEntered = false; // Asegura que la bandera de BIOS est√© a false
        bootSequenceStarted = false; // Restablecer para permitir la detecci√≥n de tecla de BIOS en el siguiente arranque
        
        // Volvemos a activar el listener inicial y el temporizador para el siguiente arranque
        document.addEventListener('keydown', initialBootKeyListener, true);
        biosTimeout = setTimeout(() => {
            if (!biosEntered) {
                document.removeEventListener('keydown', initialBootKeyListener, true);
                startBootSequence();
            }
        }, 7000);

      }, 5000);
    }

    function makeWindowDraggable(element) {
      let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
      const titleBar = element.querySelector('.title-bar');

      if (titleBar) {
        titleBar.onmousedown = dragMouseDown;
      } else {
        element.onmousedown = dragMouseDown;
      }

      function dragMouseDown(e) {
        e = e || window.event;
        e.preventDefault();
        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        document.onmousemove = elementDrag;
      }

      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        element.style.top = (element.offsetTop - pos2) + "px";
        element.style.left = (element.offsetLeft - pos1) + "px";
      }

      function closeDragElement() {
        document.onmouseup = null;
        document.onmousemove = null;
      }
    }
  </script>
</body>
</html>
